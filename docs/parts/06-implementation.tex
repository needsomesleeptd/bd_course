\chapter{Технологическая часть}
В данной части рассматривается выбор средств реализации, описывается реализация алгоритмов и построенных схем.

\section{Выбор СУБД}
В соответствии с приведенной диаграммой сущность---связь необходимо организовать хранение следующих типов данных.
\begin{enumerate}
	\item Файлы отчетов и результатов проверки работ студентов.
	\item Выделенные фрагменты и их описание.
	\item Информацию о студентах, достижениях, комментариях.
	\item Хранение файлов журнала системы (англ. logs)~\cite{kuznecov-db}.
\end{enumerate}
Также в выбранной СУБД должна быть возможность создания ролей и выдача прав в соответствии с ними.
В конструкторском разделе была определена реляционная модель баз данных для хранения информации в системе, файлы отчетов и результатов проверки будут хранится в файловой системе сервера, мета информация для их получения будет также хранится в базе данных системы.

Рассмотрим наиболее популярные реляционные СУБД~\cite{sql_popular}:
\begin{enumerate}
	\item PostgreSQL~\cite{postgres,postgres_pro_cert}.
	\item MySQL~\cite{ms_sql_server}.
	\item MS SQL~\cite{mysql}.
\end{enumerate}

Сравнение будет произведено по следующим критериям:
\begin{enumerate}
	\item Доступность в лицензии Российской Федерации.
	\item Популярность среди разработчиков.
	\item Наличие ролевой модели.
\end{enumerate}


\subsection{Доступность лицензии}
PostgreSQL является является ПО с открытым исходным кодом, ввиду чего существуют несколько версий данного продукта~\cite{postgres}. На базе PostgreSQL была разработана СУБД Postgres Pro Certified,которая сертифицирована ФСТЭК РФ~\cite{postgres_pro_cert}.Сертификация позволяет использовать ее для хранения информации:
\begin{enumerate}
	\item В значимых объектах критической информационной инфраструктуры 1 категории, в государственных информационных системах 1 класса защищенности;
	\item В автоматизированных системах управления производственными и технологическими процессами 1 класса защищенности;
	\item В информационных системах персональных данных при необходимости обеспечения 1 уровня защищенности персональных данных;
	\item В информационных системах общего пользования II класса.
\end{enumerate}

MS SQL (Microsoft SQL Server) является продуктом компании Microsoft,в 2022 году ФСТЭК принял решение об отзыве сертификатов	 данной компании~\cite{ms_sql_cert}.

MySQL не является сертифицированном продуктом на территории Российской Федерации.




Все 3 СУБД имеют ролевую модель данных\cite{ms_sql_roles,postgres,mysql_roles}.
Стоит отметить что наибольший процент использования СУБД  имеет MS~SQL, затем идет PostgreSQl, затем MySQL~\cite{sql_popular}.

В результате анализа полученных данных, была получена таблица~\ref{t:dbms_cmp}.
\begin{table}[ht]
	\centering
	\caption{Сравнение наиболее популярных СУБД}
	\begin{tabular}{|l|c|c|c|}
		\hline
		\diagbox[width=15em]{Критерии сравнения}{СУБД}&  PostgreSQL & MySQL & MS SQL \\ \hline
		Уровень защищенности & 1 & нет & нет \\ \hline
		Частота практического использования & 2 & 3 & 1 \\ \hline
		Наличие ролевой модели & да & да & да \\ \hline
	\end{tabular}
	\label{t:dbms_cmp}
\end{table}
В таблице~\ref{t:dbms_cmp} числа в строке "Частота практического использования" обозначают порядковый номер СУБД с точки зрения практического внедрения или использования~\cite{sql_popular}.

Таким образом для решения поставленной задачи стоит выбрать СУБД PostgreSQL, так как занимает второе место по популярности  и имеет сертификацию 1-го уровня защищенности(см. таблицу~\ref{t:dbms_cmp}).

Также необходимо реализовать хранения файлов журнала приложения, для этого было решено использовать СУБД временных рядов. Так как InfluxDB поддерживает использование InfluxQL подобного SQL, а также является ПО с открытым исходным кодом стоит использовать ее для хранения файлов журнала~\cite{time_db}.

\section{Выбор средств реализации}
Для реализации описанного функционала был выбран язык программирования GO, в силу следующих причин:
\begin{enumerate}
	\item Существует библиотека для данного языка, позволяющая реализовывать запросы к базам данных на уровне языка~\cite{gorm}.
	\item Язык поддерживает создание интерфейсов и структур, что позволяет выделить основные объекты и сущности при разработке и использовать их при реализации~\cite{go_interface}.
	\item GO имеет обширную документацию, в которой в каждом описываемом модуле (пакете) приведены примеры реализации и использования объектов модуля~\cite{go_package}.
\end{enumerate}

Для реализации нейронной сети был выбран язык Python, так как онн поддерживает фреймворк PyTorch, использование которого достаточно для решения задачи детекции основных частей отчета~\cite{pytorch}.


\section{Реализация создания отношений}
В листинге~\ref{lst:create.sql} приведена реализация создания отношений.
Отношения обозначают соответственно:
\begin{enumerate}
	\item documents --- сущность документа;
	\item markup\_types --- сущность типов фрагмента отчета;
	\item markups --- сущность выделенного фрагмента;
	\item users --- сущность пользователя (контроллера, админа или студента);
	\item document\_queues --- сущность элемента очереди отчета для проверки;
	\item comments --- сущность комментариев к отчету;
	\item achievments --- сущность достижения.
\end{enumerate}


\section{Реализация функций}
В листинге~\ref{lst:functions.sql} приведены реализации спроектированных функций. Функция \texttt{getTasksReady} получает все документы из очереди, которые готовы к проверке и не были проверены до этого.

\section{Реализация триггеров}
В листинге~\ref{lst:triggers.sql} приведены реализации спроектированных триггеров. Триггер \texttt{addToQueue}, при добавлении метаданных документа, в случае если в имени файла нет подстрока VIP и он не был уже проверен добавляет документ в очередь для проверки.















